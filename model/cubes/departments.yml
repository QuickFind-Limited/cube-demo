cubes:
  - name: departments
    sql: SELECT * FROM demo.departments
    title: Departments
    description: Department reference data (eCommerce, Retail, Wholesale, etc.)

    measures:
      - name: department_count
        type: count
        description: Total number of departments

      - name: active_department_count
        type: count
        filters:
          - sql: "{CUBE}.isinactive = FALSE"
        description: Number of active departments

    dimensions:
      - name: id
        sql: "{CUBE}.id"
        type: number
        primary_key: true

      - name: name
        sql: "{CUBE}.name"
        type: string
        description: Department name (eCommerce, Retail, Wholesale)

      - name: fullname
        sql: "{CUBE}.fullname"
        type: string
        description: Full department name

      - name: parent
        sql: "{CUBE}.parent"
        type: number
        description: Parent department ID

      - name: isinactive
        sql: "{CUBE}.isinactive"
        type: boolean
        description: Whether department is inactive

    segments:
      - name: active
        sql: "{CUBE}.isinactive = FALSE"

    pre_aggregations:
      - name: department_analysis
        scheduled_refresh: true
        measures:
          - department_count
          - active_department_count
        dimensions:
          - name
        refresh_key:
          every: 365 days
